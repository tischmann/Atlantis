import Dialog from"./atlantis.dialog.min.js";export default class Upload{constructor({url:e="/",data:s=null,progress:n=function(){},success:t=function(){},failure:o=function(){},method:a="POST"}={}){new Promise((t,o)=>{const r=new XMLHttpRequest;r.open(a.toUpperCase(),e),r.upload.addEventListener("progress",e=>{e.lengthComputable&&(e=e.loaded/e.total*100,n(e))}),r.onload=()=>{var e=JSON.parse(r.response);(200===r.status?t:(new Dialog({title:e.title,text:e.message}),o))(e)},r.onerror=()=>{o(new Error("Network error"))},r.send(s)}).then(t).catch(o)}}
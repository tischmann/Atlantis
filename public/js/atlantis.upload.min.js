import Dialog from"./atlantis.dialog.min.js";export default function upload({url:e="/",data:r=null,progress:a=function(){},success:t=function(){},failure:o=function(){},method:s="POST"}={}){new Promise((t,o)=>{const n=new XMLHttpRequest;n.open(s.toUpperCase(),e),n.upload.addEventListener("progress",e=>{e.lengthComputable&&(e=e.loaded/e.total*100,a(e))}),n.onload=()=>{var e=JSON.parse(n.response);(200===n.status?t:(new Dialog({title:e.title,text:e.message}),o))(e)},n.onerror=()=>{o(new Error("Network error"))},n.send(r)}).then(t).catch(o)}
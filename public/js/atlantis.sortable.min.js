export default class Sortable{dragged=null;dragStarted=!1;constructor(t,{ondragstart:e=function(){},ondragend:r=function(){}}={}){this.container=t,this.ondragstart=e,this.ondragend=r,[].slice.call(this.container.querySelectorAll("li")).forEach(function(t){t.draggable=!0}),this.container.addEventListener("dragstart",this,!1),this.container.addEventListener("dragover",this,!1),this.container.addEventListener("dragend",this,!1)}handleEvent(t){switch(t.type){case"dragstart":this.onDragStartHandler(t);break;case"dragover":this.onDragOverHandler(t);break;case"dragend":this.onDragEndHandler(t)}}onDragStartHandler(t){this.dragStarted=!0,this.dragged=t.target.closest("li"),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("Text",this.dragged.textContent),setTimeout(()=>{this.dragged.classList.add("opacity-50")},0),this.ondragstart(this,t)}onDragEndHandler(t){this.dragStarted&&(this.dragStarted=!1,t.preventDefault(),this.dragged.classList.remove("opacity-50"),this.ondragend(this,t))}onDragOverHandler(t){var e,r;this.dragStarted&&(t.preventDefault(),t.dataTransfer.dropEffect="move",e=t.target.closest("li"))&&e!==this.dragged&&"LI"===e.nodeName&&(r=this.getMouseOffset(t),t=this.getElementVerticalCenter(t.target),r.y>t?this.container.insertBefore(this.dragged,e.nextSibling):this.container.insertBefore(this.dragged,e))}getElementVerticalCenter(t){t=t.getBoundingClientRect();return(t.bottom-t.top)/2}getMouseOffset(t){var e=t.target.getBoundingClientRect();return{x:t.pageX-e.left,y:t.pageY-e.top}}destroy(){[].slice.call(this.container.querySelectorAll("li")).forEach(function(t){t.draggable=!1}),this.container.removeEventListener("dragstart",this,!1),this.container.removeEventListener("dragover",this,!1),this.container.removeEventListener("dragend",this,!1)}}
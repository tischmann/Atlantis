import Dialog from"./atlantis.dialog.min.js";const form=document.getElementById("user-form"),saveButton=document.getElementById("save-user"),deleteButton=document.getElementById("delete-user"),addButton=document.getElementById("add-user");function sendRequest(e,t,n=null,o=null){null===o&&(o=function(){window.location.reload()}),fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:n}).then(e=>{e.json().then(e=>{new Dialog({title:e.title,text:e.message,onclose:()=>{o(e)}})})})}saveButton?.addEventListener("click",function(){sendRequest("/user/"+form.dataset.id,"PUT",JSON.stringify(Object.fromEntries(new FormData(form))))}),addButton?.addEventListener("click",function(){sendRequest("/user","POST",JSON.stringify(Object.fromEntries(new FormData(form))),function({id:e}){window.location.href="/user/"+e})}),deleteButton?.addEventListener("click",function(){confirm(form.dataset.confirm)&&sendRequest("/user/"+form.dataset.id,"DELETE",null,function(){window.location.href="/users"})});
import Atlantis from"/js/atlantis.js";const atlantis=new Atlantis;atlantis.on(window,"load",()=>{const l=document.querySelector("[data-tinymce-textarea]");let n=l.dataset.token;var e=window.matchMedia("(prefers-color-scheme: dark)").matches;tinymce.init({language:l.dataset.locale,target:l,plugins:"preview importcss searchreplace autolink autosave save directionality code visualblocks visualchars fullscreen image link media template codesample table charmap pagebreak nonbreaking anchor insertdatetime advlist lists wordcount help charmap quickbars emoticons",editimage_cors_hosts:["picsum.photos"],menubar:"file edit view insert format tools table help",toolbar:"undo redo | bold italic underline strikethrough | fontfamily fontsize blocks | alignleft aligncenter alignright alignjustify | outdent indent |  numlist bullist | forecolor backcolor removeformat | pagebreak | charmap emoticons | fullscreen  preview save print | insertfile image media template link anchor codesample | ltr rtl",height:600,quickbars_selection_toolbar:"bold italic | quicklink h2 h3 blockquote quickimage quicktable",noneditable_class:"mceNonEditable",toolbar_mode:"floating",contextmenu:"link image table",image_caption:!0,skin:e?"oxide-dark":"oxide",content_css:e?"dark":"default",image_advtab:!0,images_upload_handler:(i,s)=>new Promise((t,a)=>{var e=new FormData;e.append("file",i.blob(),i.filename());const o=new XMLHttpRequest;o.withCredentials=!0,o.open("POST","/upload/article/image/"+l.dataset.id),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("X-Csrf-Token",n),o.upload.onprogress=e=>{s(e.loaded/e.total*100)},o.onload=()=>{var e;403===o.status?a({message:"HTTP Error: "+o.status,remove:!0}):o.status<200||300<=o.status?a("HTTP Error: "+o.status):(console.log(o.responseText),(e=JSON.parse(o.responseText))&&"string"==typeof e.thumb_location?(n=e.token,t(e.thumb_location)):a("Invalid JSON: "+o.responseText))},o.onerror=()=>{a("Image upload failed due to a XHR Transport error. Code: "+o.status)},o.send(e)})})});